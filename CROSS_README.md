## 跨服天梯架构图　　
 ![](/screenshots/1.png "通信架构图")

匹配服--有且只有一个服务（http服务）。接受所有游戏服的报名请求，匹配并分配战斗服。

战斗服--中立服务器，没有原始玩家。战斗服数量有限但可水平扩展。

游戏服--从匹配服获取比赛分组，将玩家传输到战斗服。

比赛流程：
比赛开始前，战斗服定时向匹配服发送心跳包，心跳包包含战斗服自身ip地址及端口；
匹配服维护一份有效到战斗服列表。

比赛开始时，游戏服的玩家进行报名，游戏服通过http把数据发到匹配服。

匹配服定时对上报数据进行分配跨服房间，由游戏服定时消费匹配结果。

游戏服拿到匹配结果后，将玩家传到战斗服。并通知客户端将socket切到战斗服。
比赛结束后，战斗服将玩家踢回原游戏服。

 

